name: Latest Blog Posts Workflow

on:
  schedule:
    - cron: '0 */8 * * *'     # প্রতি ৮ ঘণ্টায় একবার চলবে
  workflow_dispatch:          # ম্যানুয়ালি চালানো যাবে

jobs:
  update-readme:
    runs-on: ubuntu-latest
    permissions:
      contents: write

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Update README with latest blog posts
        uses: anandchowdhary/latest-blog-post-workflow@v1
        with:
          feed: https://iptvpulse.top/feeds/posts/default?alt=rss
          count: 20
          template: |
            <br/>
            <a href="$url">
              <img src="$image" align="left" width="145" hspace="12" style="border-radius:10px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);"/>
            </a>
            <a href="$url"><b>$title</b></a><br/>
            <i>$date</i><br clear="left"/>
            <br/>

      - name: Commit & Push if changed
        run: |
          git config user.name "Automated Bot"
          git config user.email "actions@github.com"
          git add -A
          git diff --quiet && git diff --staged --quiet || (git commit -m "Updated latest blog posts" && git push)
